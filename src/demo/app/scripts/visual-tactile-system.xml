<application>

  <name>VisualTactileLocalization</name>
  <description>Visual-tactile localization</description>

  <authors>
    <author>Nicola Piga</author>
  </authors>

  <module>
    <name>yarpdev</name>
    <description>Frame Transform Server</description>
    <node>localhost</node>
    <parameters>--device FrameTransformServer --ROS::enable_ros_publisher false --ROS::enable_ros_subscriber false</parameters>
  </module>

  <module>
    <name>upf-localizer</name>
    <description>UPF filter</description>
    <node>localhost</node>
    <parameters>--context visualTactileLocalization</parameters>
    <dependencies>
      <!-- the filter publishes the estimated pose on the transform server -->
      <port timeout="5.0">/transformServer/transforms:o</port>
    </dependencies>
    <environment>YARP_FORWARD_LOG_ENABLE=1</environment>
  </module>
  
  <module>
    <name>vtl-hand-ctrl</name>
    <node>localhost</node>
    <parameters>--context visualTactileLocalization --robotName icub --handName right --useSimulatedContacts false</parameters>
    <environment>YARP_FORWARD_LOG_ENABLE=1</environment>
  </module>

  <module>
    <name>vtl-hand-ctrl</name>
    <node>localhost</node>
    <parameters>--context visualTactileLocalization --robotName icub --handName left --useSimulatedContacts false</parameters>
    <environment>YARP_FORWARD_LOG_ENABLE=1</environment>
  </module>

  <!-- <module> -->
  <!--   <name>vtl-filter-point-cloud</name> -->
  <!--   <node>localhost</node> -->
  <!--   <parameters>uniform-sample 30</parameters> -->
  <!-- </module> -->

  <module>
    <name>vtl-vtk-viewer</name>
    <node>localhost</node>
    <parameters>--context visualTactileLocalization</parameters>
  </module>

  <module>
    <name>vtl-si-viewer</name>
    <node>cuda</node>
    <parameters>--context visualTactileLocalization</parameters>
  </module>

  <module>
    <name>vtl-gtruth-tracker</name>
    <node>localhost</node>
    <parameters>--context visualTactileLocalization</parameters>
  </module>

  <module>
    <name>yarpview</name>
    <node>localhost</node>
    <parameters>--name /si_estimate_viewer/viewer:i --compact</parameters>
  </module>

  <module>
    <name>yarpview</name>
    <node>localhost</node>
    <parameters>--name /gtruth_viewer/viewer:i --compact</parameters>
  </module>

  <!-- <module> -->
  <!--   <name>velocityObserver</name> -->
  <!--   <node>localhost</node> -->
  <!--   <parameters>name /vis_tactile_localization/torsoObserver lenVel 20 thrVel 2.0</parameters> -->
  <!--   <environment>YARP_FORWARD_LOG_ENABLE=1</environment> -->
  <!-- </module> -->

  <!-- <module> -->
  <!--   <name>velocityObserver</name> -->
  <!--   <node>localhost</node> -->
  <!--   <parameters>name /vis_tactile_localization/leftArmObserver lenVel 20 thrVel 2.0</parameters> -->
  <!--   <environment>YARP_FORWARD_LOG_ENABLE=1</environment> -->
  <!-- </module> -->

  <!-- <connection> -->
  <!--   <from>/icub/torso/state:o</from> -->
  <!--   <to>/vis_tactile_localization/torsoObserver/pos:i</to> -->
  <!-- </connection> -->

  <!-- <connection> -->
  <!--   <from>/vis_tactile_localization/torsoObserver/vel:o</from> -->
  <!--   <to>/upf-localizer/torsoObserver/vel:i</to> -->
  <!-- </connection> -->

  <!-- <connection> -->
  <!--   <from>/icub/left_arm/state:o</from> -->
  <!--   <to>/vis_tactile_localization/leftArmObserver/pos:i</to> -->
  <!-- </connection> -->

  <!-- <connection> -->
  <!--   <from>/vis_tactile_localization/leftArmObserver/vel:o</from> -->
  <!--   <to>/upf-localizer/leftArmObserver/vel:i</to> -->
  <!-- </connection> -->

  <!-- <connection> -->
  <!--   <from>/pointCloudRead/pointCloud:o</from> -->
  <!--   <to>/filter-point-cloud/pointcloud:i</to> -->
  <!-- </connection> -->

  <connection>
    <from>/pointCloudRead/pointCloud:o</from>
    <to>/view-filtering/pointcloud:i</to>
  </connection>

  <connection>
    <from>/pointCloudRead/pointCloud:o</from>
    <to>/upf-localizer/pc:i</to>
  </connection>

  <!-- <connection> -->
  <!--   <from>/filter-point-cloud/filtered-pointcloud:o</from> -->
  <!--   <to>/upf-localizer/filtered-pc:i</to> -->
  <!-- </connection> -->

  <!-- <connection> -->
  <!--   <from>/icub/skin/right_hand_comp</from> -->
  <!--   <to>/upf-localizer/contacts:i</to> -->
  <!-- </connection> -->

  <connection>
    <from>/icub/skin/left_hand_comp</from>
    <to>/upf-localizer/contacts:i</to>
  </connection>

  <!-- <connection> -->
  <!--   <from>/icub/skin/right_hand_comp</from> -->
  <!--   <to>/hand-control/right/contacts:i</to> -->
  <!-- </connection> -->

  <connection>
    <from>/icub/skin/left_hand_comp</from>
    <to>/hand-control/left/contacts:i</to>
  </connection>

  <connection>
    <from>/icub/camcalib/left/out</from>
    <to>/si_estimate_viewer/left_eye:i</to>
  </connection>

  <connection>
    <from>/si_estimate_viewer/left_eye:o</from>
    <to>/si_estimate_viewer/viewer:i</to>
  </connection>

  <connection>
    <from>/icub/camcalib/left/out</from>
    <to>/gtruth_tracker/left_eye:i</to>    
  </connection>

  <connection>
    <from>/gtruth_tracker/left_eye:o</from>
    <to>/gtruth_viewer/viewer:i</to>
  </connection>

</application>
